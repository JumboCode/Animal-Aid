{% extends 'base.html' %}

  {% block javascript %}
  <script>
    console.log("TESTING");
    $("#id_email").on('input', function () {
      console.log( $(this).val() );
      var email = $(this).val();
      $.ajax({
        url: '/ajax/validate_username/',
        data: {
          'email': email
        },
        dataType: 'json',
        success: function (data) {
<<<<<<< HEAD
          // if (!(data.tufts_edu)) {
          //   console.log("The email does not with tufts.edu");
          //   $("#id_email").addClass('error');
          // }
          // else {
          //   $("#id_email").removeClass('error')
          // }
          data.tufts_edu ? $("#id_email").removeClass('error') : $("#id_email").addClass('error');
=======
          if (data.tufts_edu) {
            console.log("The email does not with tufts.edu");
          }
>>>>>>> 53bd96ee646d3d948a61a3d6599b505b76e55501
        }
      });
    });
    $("#id_password1").on('input', function () {
      console.log( $(this).val() );
      var password1 = $(this).val();
      $.ajax({
        url: '/ajax/validate_password1/',
        data: {
          'password1': password1
        },
        dataType: 'json',
        success: function (data) {
          var has_error = false;
          if (data.too_short) {
            has_error = true;
            console.log("The password is too short");
          }
          if (data.no_special_char) {
            has_error = true;
            console.log("The password is too weak");
          }
          if (data.too_common) {
            has_error = true;
            console.log("The password is too common");
          }
          if (data.only_digits) {
            has_error = true;
            console.log("The password cannot be only digits");
          }
          console.log("FLAG", has_error);
          has_error ? $("#id_password1").addClass('error') : $("#id_password1").removeClass('error');
        }
      });
    });
  </script>
{% endblock %}

  {% block content %}
    <nav> 
      <li {% if active_link == "home" %}class="active"{% endif %}><a href="{% url 'home' %}">Home</a></li> 
      <li {% if active_link == "signup" %}class="active"{% endif %}><a href="{% url 'signup' %}">Sign Up</a></li> 
      <li {% if active_link == "login" %}class="active"{% endif %}><a href="{% url 'login' %}">Login</a></li> 
      <li {% if active_link == "password_reset" %}class="active"{% endif %}><a href="{% url 'password_reset' %}">Forgot your password?</a></li> </nav>
    </nav>
    <h2>Sign up</h2>
    <form method="post">
      {% csrf_token %}
      {% for field in form %}
        <p>
          {{ field.label_tag }}<br>
          {{ field }}
          {% for error in field.errors %}
<<<<<<< HEAD
            <p style="color: red">{{ error }} {% if error == "A user with that email already exists" %} </p>
            {% endif %}
=======
            <p style="color: red">{{ error }} {% if error == "A user with that email already exists" %}</p>
              <!-- <a href ="{% url 'login' %}"> Login? </a>{% endif %} -->
>>>>>>> 53bd96ee646d3d948a61a3d6599b505b76e55501
          {% endfor %}
        </p>
      {% endfor %}
      <button type="submit">Sign up</button>
    </form>
  {% endblock %}